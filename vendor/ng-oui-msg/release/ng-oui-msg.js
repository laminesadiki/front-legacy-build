/**
 * ng-oui-msg - v5.0.0 - 2014-11-05
 *
 * Copyright (c) 2014 Oodrive
 */
!function(a){!function(){"use strict";a.module("oui.msg.alert",["oo.i18n"]).provider("$ouiMsgAlert",function(){var b=0,c=4,d=5e3,e=/(?:^|;)\s*([^\s;]+)\s*:\s*([^;]+?)\s*(?=;|$)/g,f=/\{\{([a-z]+)\}\}/gi,g={valid:{type:"valid",msg:"i18n:common.success",closable:!0,iconName:"check"},alert:{type:"alert",msg:"i18n:common.warning",closable:!0,iconName:"warning"},fail:{type:"fail",msg:"i18n:common.fail",closable:!0,iconName:"cross"}},h='<ul class="oo-alert-message-container"></ul>',i=['<li class="oo-alert-message oo-alert-message-{{type}}">','<div class="oo-alert-message-inner">','<i class="oo-icon {{icon}}"></i>','<span class="oo-alert-message-text">{{msg}}</span>',"</div>",'<div class="oo-close-action">','<i class="icon-close"></i>',"</div>","</li>"].join(""),j={};this.$get=["$filter","$timeout","$injector","$rootScope",function(k,l,m,n){function o(a){var b=$(a).closest(".oo-alert-message-context, .oo-sp-page, .oo-ws-page");return b.addClass("oo-alert-message-context")}function p(a,b,d){var e;a=d?$(a):o(a),e=a.attr("data-max-size"),a.attr("data-max-size",b||e||c)}function q(a){return $(" > .oo-alert-message-container:first",a)}function r(a){var b=$(h);return $(a).append(b),b.on("click",".oo-close-action",function(){var a=$(this).closest(".oo-alert-message").attr("data-msg-id");w(a)})}function s(c){var g,h,j="message_"+ ++b,l=c.cls;return g=i.replace(f,function(a,b){var d;switch(b){case"type":d=c.type;break;case"icon":d=c.iconName.length?"icon-"+c.iconName:"";break;case"msg":d=k("i18nOrText")(c.msg)}return d}),h=$(g),h.attr("data-msg-id",j),l&&h.addClass(l),c.style&&c.style.replace(e,function(a,b,c){h.css(b,c)}),c.closable&&h.addClass("oo-closable"),c.timeout&&(c.timeout=parseInt(c.timeout,10)||null,h.attr("data-timeout",c.timeout||d)),a.isFunction(c.onClose)&&h.on("alertMsg.close",function(){c.onClose()}),h}function t(b,c){var d=$('.oo-alert-message[data-msg-id="'+b+'"]');return b&&d.length&&c&&a.isNumber(parseInt(c,10))?(j[b]=l(function(){w(b)},c),void j[b]["finally"](function(){delete j[b]})):!1}function u(a){a=$(a);var b=a.find(".oo-alert-message"),c=b.length,d=o(a).attr("data-max-size"),e=c-d;b.each(function(a,b){b=$(b);var f=b.attr("data-msg-id"),g=b.attr("data-timeout"),h=b.is(":visible");h&&c>d&&e>a&&(g&&l.cancel(j[f]),x?(x.removeClass(b,"oui-show"),setTimeout(function(){n.$digest()},1)):b.removeClass("oui-show")),!h&&(c>d&&a>=e||d>=c)&&(x?(x.addClass(b,"oui-show").then(function(){"undefined"!=typeof g&&t(f,g)}),setTimeout(function(){n.$digest()},1)):(b.addClass("oui-show"),"undefined"!=typeof g&&t(f,g)))}),!a.find(".oo-alert-message").length&&$(a).remove()}function v(a,b){b=$(b);var c=b.find(".oo-alert-message"),d=c.length,e=o(b).attr("data-max-size"),f=d-e;f>=0?c.eq(f).after(a):b.prepend(a)}function w(b){var c,d;if(!b||!a.isString(b))return!1;c=$(".oo-alert-message[data-msg-id="+b+"]"),d=c.closest(".oo-alert-message-container");var e=function(){c.trigger("alertMsg.close"),c.remove(),u(d)};x?(x.removeClass(c,"oui-show").then(e),setTimeout(function(){n.$digest()},1)):(c.removeClass("oui-show"),e())}var x=null;return m.has("$animate")&&(x=m.get("$animate")),{show:function(b,c,d){var e,f,h,i,j={type:"alert"};return!a.isElement(b)&&a.isString(b)?(d=a.isObject(c)?c:{},c=b,d.msg=c,b=d.context||document):a.isElement(b)&&a.isObject(c)?d=c:!a.isElement(b)&&a.isObject(b)?(d=b,b=d.context||document):d.msg=c,a.extend(j,g[d.type||j.type]),a.extend(j,d),e=j.forceCtxt?b:o(b),p(e,void 0,j.forceCtxt),f=q(e),f.length||(f=r(e)),h=s(j),i=function(){w(h.attr("data-msg-id"))},j.immediate?v(h,f):f.prepend(h),u(f),{msgElt:h[0],close:i}},setDisplayableItems:p,flush:function(a){a?(a=$(a),a.find(".oo-alert-message").each(function(a,b){w($(b).attr("data-msg-id"))})):$(".oo-alert-message").each(function(a,b){w($(b).attr("data-msg-id"))})}}}]})}(),function(){var b,c,d,e,f,g,h=.5,i=["yes","no","ok","confirm","cancel","close"];a.module("oui.msg.modal",["oo.i18n","oo.stringsUtils"]).provider("$ouiMsgModal",function(){function j(){s.modalWrapper=$(['<div class="oo-modal-message-wrapper" tabindex="-1">','<div class="oo-modal-message">','<div class="oo-close-action"><i class="icon-close"></i></div>','<div class="oo-modal-message-inner">','<i class="oo-icon"></i>','<div class="oo-modal-message-content">','<div class="oo-modal-message-text-wrapper">','<div class="oo-modal-message-text">','<h3 class="oo-title"></h3>',"<p></p>","</div>","</div>",'<div class="oo-actions"></div>',"</div>","</div>","</div>","</div>"].join("")),s.mask=$('<div class="oo-modal-message-mask" tabindex="-1"></div>'),s.modal=s.modalWrapper.find(".oo-modal-message"),s.close=s.modal.find(".oo-close-action"),s.icon=s.modal.find(".oo-icon"),s.content=s.modal.find(".oo-modal-message-content"),s.contentTextWrapper=s.modal.find(".oo-modal-message-text-wrapper"),s.contentText=s.contentTextWrapper.find(".oo-modal-message-text"),s.title=s.contentText.find(".oo-title"),s.text=s.contentText.find("p"),s.actions=s.modal.find(".oo-actions"),$("body").append(s.mask,s.modalWrapper),v.opacity=s.mask.css("opacity")?parseFloat(s.mask.css("opacity")):h,s.modalWrapper.on("click",".oo-form-button, .oo-close-action",function(){var b=$(this),c=b.data("btnIndex"),d=u[0],e=d.promiseReturn,f=d.buttons[c]||{},g=f.onClick,h=f.id;b.hasClass("oo-close-action")?d.config.closable&&(d.deferred.resolve(a.extend({event:"hide",origin:"close"},e)),d.config.beforeHide&&d.config.beforeHide({event:"hide",origin:"close"})===!1||r()):(d.deferred.resolve(a.extend({event:"button",btnId:h,index:c},e)),g=d.buttons[c].onClick,g&&("close"===g?d.config.beforeHide&&d.config.beforeHide({event:"button",btnId:h,index:c})===!1||r():a.isFunction(g)&&g()))});var b=function(b){var c=u[0];c&&27===b.keyCode&&c.config.closable&&(c.deferred.resolve(a.extend({event:"hide",origin:"escKey"},c.promiseReturn)),c.config.beforeHide&&c.config.beforeHide({event:"hide",origin:"escKey"})===!1||r())};s.modalWrapper.on("keydown",b),s.mask.on("keydown",b)}function k(){s.contentTextWrapper.css("height",f.pxToEm(s.modal.height()-(s.content.outerHeight()-s.content.height())-s.actions.outerHeight(),s.contentText)+"em")}function l(){s.contentTextWrapper.css("height","")}function m(){s.modalWrapper.attr("class","oo-modal-message-wrapper"+(s.modalWrapper.hasClass("oui-show")?" oui-show":"")),s.mask.attr("class","oo-modal-message-mask"+(s.mask.hasClass("oui-show")?" oui-show":"")),s.icon.attr("class","oo-icon"),s.title.empty(),s.text.empty(),s.actions.empty(),l()}function n(a){var b=e.defer();if(s.mask.css("opacity",a.opacity||""),s.modalWrapper.hasClass("oui-show"))return b.resolve(),b.promise;l();var f=e.defer(),g=e.defer();return a.mask===!1?f.resolve():c.addClass(s.mask,"oui-show").then(function(){f.resolve()}),c.addClass(s.modalWrapper,"oui-show").then(function(){g.resolve()}),e.all([f.promise,g.promise]).then(function(){b.resolve()}),setTimeout(function(){k(),d.$digest()},1),b.promise}function o(a,b){var f=e.defer();if(!s.modalWrapper.hasClass("oui-show"))return f.resolve(),f.promise;if(b)return!a&&s.mask.removeClass("oui-show"),s.modalWrapper.removeClass("oui-show"),l(),f.resolve(),f.promise;var g=e.defer(),h=e.defer();return a?g.resolve():c.removeClass(s.mask,"oui-show").then(function(){g.resolve()}),c.removeClass(s.modalWrapper,"oui-show").then(function(){h.resolve()}),e.all([g.promise,h.promise]).then(function(){l(),f.resolve()}),setTimeout(function(){d.$digest()},1),f.promise}function p(a){var b=-1;return"object"==typeof a&&a.id&&(a=a.id),$.each(u,function(c,d){return d.id===a?(b=c,!1):void 0}),b}var q,r,s={},t=0,u=[],v={title:"Error !",closable:!0,iconName:"exclamation2",buttons:["ok"]},w=/(?:^|;)\s*([^\s;]+)\s*:\s*([^;]+?)\s*(?=;|$)/g,x=!1;this.init=function(){x||(x=!0,j())},b=this.init,this.$get=["$filter","$rootScope","$timeout","$q","$injector","$ooConvert",function(b,j,k,l,x,y){function z(){if(u.length){var b=u[0],c=b.config;m(),A.title(c.title),A.msg(c.msg),A.cls(b),A.closable(b),A.icon(c.iconName),A.style(c),A.buttons(b),n(c).then(function(){setTimeout(function(){null===c.focus?s.modalWrapper.focus():c.focus?s.actions.find(".oo-form-button[data-action="+c.focus+"]").first().focus():s.actions.find(".oo-form-button").first().focus()},1),a.isFunction(c.onShow)&&c.onShow()}),c.timeout&&(c.timeout=parseInt(c.timeout,10))&&(c.timeout=c.timeout>=100?c.timeout:1e3*c.timeout,b.timeout=k(function(){b.deferred.resolve(a.extend({event:"hide",origin:"timeout"},b.promiseReturn)),b.config.beforeHide&&b.config.beforeHide({event:"hide",origin:"timeout"})===!1||r(b.id)},c.timeout))}}e=l,f=y,d=j,j.$on("$langChange",function(){var a=u[0],c=a&&a.config;a&&(s.actions.find(".oo-form-button").each(function(c,d){$(d).text(b("i18nOrText")(a.buttons[c].text))}),c&&s.title.text(b("i18nOrText")(c.title)),c&&c.msg&&s.text.html(b("escapeHtml")(b("i18nOrText")(c.msg),!1,!0)))});var A={title:function(a){s.title.text(b("i18nOrText")(a))},msg:function(a){a&&(s.modalWrapper.addClass("oo-has-text"),s.text.html(b("escapeHtml")(b("i18nOrText")(a),!1,!0)))},cls:function(a){var b=a.config.cls;b&&(s.modalWrapper.addClass(b),a.config.maskCls=b.replace(/(\s+|$)/g,"-mask$1"),s.mask.addClass(a.config.maskCls))},closable:function(a){a.config.closable&&s.modalWrapper.addClass("oo-closable")},icon:function(a){s.icon.addClass("icon-"+a)},style:function(a){s.modalWrapper.attr("style",""),a.style&&a.style.replace(w,function(a,b,c){s.modalWrapper.css(b,c)}),a.opacity=a.opacity&&(a.opacity=Math.abs(parseFloat(a.opacity)))?a.opacity<=1?a.opacity:a.opacity/100:h},buttons:function(c){var d=c.config,e=d.buttons,f=!1;e&&e.length&&(s.modalWrapper.addClass("oo-has-actions"),a.forEach(e,function(b){f=f||a.isArray(b)}),f||(e=[e]),c.buttons=[],a.forEach(e,function(d){var e;d=a.isArray(d)?d:[d],e=$("<div></div>"),s.actions.append(e),a.forEach(d,function(d){var f,g=null;"string"==typeof d?g=d:d&&d.type&&(g=d.type),g&&(d=a.extend(a.copy(q[g.toLowerCase()]),"string"==typeof d?{}:d)),c.buttons.push(d),f=$('<button class="oo-form-button"'+(g?' data-action="'+g+'"':"")+"></button>"),d.text&&f.text(b("i18nOrText")(d.text)),d.cls&&f.addClass(d.cls),f.data("btnIndex",c.buttons.length-1),e.append(f)})}))}};return r=function(a){var b=a?p(a):0;if(-1===b)return!1;u[b].timeout&&k.cancel(u[b].timeout);var c=function(){u.splice(b,1),u.length&&0===b&&z()};0===b?o(u.length>1&&u[1].config.mask!==!1).then(c):c()},g=function(b,c){for(var d=[],e=0;e<u.length;++e){var f=u[e];f.deferred.resolve(a.extend({event:"hide",origin:b||"service",originInfo:c},f.promiseReturn)),f.config.beforeHide&&f.config.beforeHide({event:"hide",origin:b||"service",originInfo:c})===!1?d.push(f):0===e&&o(!1,!0)}u=d,z()},q={},a.forEach(i,function(a){q[a]={id:a,text:"i18n:common."+a,cls:"greyscale",onClick:"close"}}),{show:function(b,d,e){a.isDefined(c)||(c=x.get("$animate"));var f={id:"modal_"+ ++t,deferred:l.defer(),promiseReturn:{close:function(){r(f.id)}},config:{}};return"object"==typeof b?(e=b,b=null,d=null):"object"==typeof d?(e=d,d=null,e=a.extend({title:b},e)):e=a.extend({title:b,msg:d},e),a.extend(f.config,v,e),f.config.immediate?(u.splice(0,0,f),z()):(u.push(f),1===u.length&&z()),f.deferred.promise},hide:function(){var b=u[0];b.deferred.resolve(a.extend({event:"hide",origin:"service"},b.promiseReturn)),b.config.beforeHide&&b.config.beforeHide({event:"hide",origin:"service"})===!1||r()},hideAllImmediate:g,confirm:function(b,c,d){var e={iconName:"interrogation",closable:!0,buttons:["ok","cancel"]};return a.isArray(d)?e.buttons=d:a.isObject(d)&&a.extend(e,d),this.show(b,c,e)},BUTTONS_CONFIRM_CANCEL:["confirm","cancel"],BUTTONS_OK_CANCEL:["ok","cancel"],BUTTONS_YES_CANCEL:["yes","cancel"],BUTTONS_YES_NO:["yes","no"]}}]}).provider("ouiMsgErrorInterceptor",function(){var b="i18n:common.error",c="i18n:oui.msg.modal.error.default",d=[],e={403:{},404:{},500:{},503:{}},f=[];this.defaultErrorTitle=function(c){return a.isDefined(c)?void(b=c):b};var g=function(a){d.push(a)};this.addIgnored=g;var h=function(b,c){c?e[b]=a.extend(e[b]||{},c):delete e[b]},i=function(a){f.push(a)};this.setHandledCode=h,this.addHandledError=i;var j=function(a,b,c,e){for(var f=0;f<d.length;++f){if("string"==typeof d[f])return d[f]===b;if("function"==typeof d[f])return d[f](a,b,c,e);if(d[f]&&d[f].test)return d[f].test(b)}return!1},k=function(a,b,c,d){for(var g=null,h=0;h<f.length;++h)if(f[h].isHandled&&f[h].isHandled(a,b,c,d)){g=f[h];break}return!g&&e[a]&&(g=e[a]),g&&j(a,b,c,d)&&(g=null),g};this.$get=["$q","$filter","$ouiMsgModal",function(d,e,f){var h=function(d,e,g,h,i){"number"==typeof d&&(i=h,h=g,g=e,e=d,d=null);var j,l;return d||(d=k(e,g,h,i)),d?(d.errorTitle||d.errorMsg?(j=("function"==typeof d.errorTitle?d.errorTitle(e,g,h,i):d.errorTitle)||b,l=("function"==typeof d.errorMsg?d.errorMsg(e,g,h,i):d.errorMsg)||""):(j=b,l=c),f.show(a.extend({title:j,msg:l},d)),!0):!1};return{addHandledError:i,addIgnored:g,displayError:h,responseError:function(a){return h(a.status,a.config.url,a.config.method,a.data),d.reject(a)}}}]}).run(["$rootScope",function(a){b(),a.$on("oo.layoutReflow",function(a,b){g("reflow",b)})}])}()}(angular);