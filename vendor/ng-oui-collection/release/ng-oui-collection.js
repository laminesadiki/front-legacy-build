/**
 * ng-oui-collection - v6.0.1 - 2014-11-17
 *
 * Copyright (c) 2014 Oodrive
 */
!function(a){!function(){a.module("oui.collection.cart",["oui-templates-collection"]).directive("ouiCollectionCartTitle",function(){return{restrict:"AE",scope:{title:"@ouiCollectionCartTitle",emptyClick:"&"},controller:["$scope","$element","$filter",function(a,b,c){a.getTitle=function(){return c("i18nOrText")(a.title||"i18n:collection.cart.title")}}],templateUrl:"oui-collection/cart/cartTitle.tpl.html",replace:!0}})}(),function(){a.module("oui.collection",["oui.collection.service","oui.collection.list","oui.collection.tiles","oui.collection.mixed","oui.collection.sort","oui.collection.views","oui.collection.filter","oui.collection.crumbs","oui.collection.header","oui.collection.cart"])}(),function(){var b=200;a.module("oui.collection.crumbs",["oo.convert","oui-templates-collection","oui.collection.filter"]).directive("ouiCollectionCrumbs",function(){return{require:"^?ouiCollectionHeader",restrict:"AE",scope:{crumbsConfig:"=?ouiCollectionCrumbs",crumbs:"=?",crumbsController:"=?",filterValue:"=?"},controller:["$scope","$element","$ooConvert","$timeout",function(a,c,d,e){c.on("click","[oui-crumbs-idx]",function(){var b=parseInt($(this).attr("oui-crumbs-idx"),10),c=a.crumbs[b];(!a.crumbsConfig.isClickable||a.crumbsConfig.isClickable(c))&&a.$apply(function(){a.crumbsConfig.onCrumbClick&&a.crumbsConfig.onCrumbClick(c)})}),a.getLabel=function(b){return"function"==typeof a.crumbsConfig.label?a.crumbsConfig.label(b):b[a.crumbsConfig.label]},a.isListFiltered=function(){return!!a.filterValue};var f=function(){var e,f=c,g=c.find(".oo-collection-crumbs").first(),h=c.find(".oo-collection-crumbs-full"),i=c.find(".oo-collection-crumbs-dummy"),j=c.width(),k=a.crumbsConfig.getSubstractedWidth&&a.crumbsConfig.getSubstractedWidth()||0,l=j-k;g.css("width",d.pxToEm(l,g)+"em"),h.css("width",d.pxToEm(l,h)+"em");var m=null,n=!0,o=i.find(".oo-collection-crumb-susp").width(),p=i.width()-o;if(p>l){var q=[];i.find(".oo-collection-crumb").each(function(){m=m||$(this).find(".icon-circle_forward").width(),q.push({width:$(this).width()})});var r=p,s=a.crumbsConfig.cutCrumbWidth||b;for(e=0;e<q.length&&r>l;++e)q[e].width>s&&(r-=q[e].width-s,q[e].width=s,q[e].ellipsis=!0);if(r>l)for(r+=o,n=!1,e=0;e<q.length-1&&r>l;++e)r-=q[e].width,q[e].hidden=!0;for(e=0;e<q.length;++e){var t=g.find(".oo-collection-crumb:eq("+e+")").css("display",q[e].hidden?"none":"inline").find(".oo-text");t.css("width",q[e].ellipsis?d.pxToEm(q[e].width-m,t)+"em":"auto")}g.find(".oo-collection-crumb-susp").css("display",n?"none":"inline"),f.addClass("oo-collection-crumbs-simplified")}else g.find(".oo-collection-crumb-susp").css("display",n?"none":"inline"),f.removeClass("oo-collection-crumbs-simplified")};a.$watchCollection("crumbs",function(){e(f)}),a.$watchCollection("filterValue",function(){e(f)});var g,h=function(){clearTimeout(g),g=setTimeout(f,100)};$(window).on("resize.collectionCrumbs",h);var i=a.$on("$destroy",function(){$(window).off("resize.collectionCrumbs",h),i()});a.crumbsController={},a.crumbsController.updateCrumbs=f}],link:function(a,b,c,d){d&&d.setCrumbs(a)},templateUrl:"oui-collection/crumbs/crumbs.tpl.html",replace:!0}})}(),function(){a.module("oui.collection.filter",["oui-templates-collection"]).directive("ouiCollectionFilter",function(){return{restrict:"AE",scope:{filterValue:"=ouiCollectionFilter"},controller:["$scope",function(a){a.clearFilter=function(){a.filterValue=null}}],templateUrl:"oui-collection/filter/filter.tpl.html",replace:!0}})}(),function(){a.module("oui.collection.header",["oui-templates-collection"]).directive("ouiCollectionHeader",function(){return{restrict:"AE",transclude:!0,scope:{},controller:["$scope","$element",function(a,b){this.setCrumbs=function(b){a.crumbs=b},this.setSort=function(b){a.sort=b},a.$watch("crumbs.crumbsConfig",function(){a.crumbs&&a.crumbs.crumbsConfig&&(a.crumbs.crumbsConfig.getSubstractedWidth=a.crumbs.crumbsConfig.getSubstractedWidth||function(){return b.find(".oo-collection-header-right").width()})}),a.$watchCollection("sort",function(){setTimeout(function(){a.crumbs&&a.crumbs.crumbsController&&a.crumbs.crumbsController.updateCrumbs()},1)}),a.headerContentElements=[],this.addHeaderContentElement=function(b){a.headerContentElements.push(b)},a.headerRightElements=[],this.addHeaderRightElement=function(b){a.headerRightElements.push(b)}}],link:function(b,c){if(b.headerContentElements.length){var d=c.find(".oo-collection-header-inner");a.forEach(b.headerContentElements,function(a){d.append(a)})}if(b.headerRightElements.length){var e=$('<div class="oo-collection-header-right oui-vertical-center"></div>');c.append(e),a.forEach(b.headerRightElements,function(a){e.append(a)})}},templateUrl:"oui-collection/header/header.tpl.html",replace:!0}}).directive("ouiCollectionHeaderContent",function(){return{require:"^?ouiCollectionHeader",restrict:"AE",link:function(a,b,c,d){d.addHeaderContentElement(b)}}}).directive("ouiCollectionHeaderRight",function(){return{require:"^?ouiCollectionHeader",restrict:"AE",link:function(a,b,c,d){d.addHeaderRightElement(b)}}})}(),function(){a.module("oui.collection.list",["oui.collection.service"]).directive("ouiList",["$ouiCollection",function(a){return{restrict:"AE",scope:{config:"=?ouiList",itemConfig:"=?lineConfig",columns:"=?",absoluteItems:"=?",data:"=?",nbSelected:"=?",selectedIds:"=?",listController:"=?ouiListController",limitWatchers:"=?limitWatchers",cartController:"=?cartController",loading:"=?loading",sort:"=?sort",filter:"=?filter",page:"=?",pageCount:"=?"},controller:["$scope","$element","$attrs",function(b,c,d){b.collectionType="list",b.itemConfig=b.itemConfig||{type:"list",columns:b.columns},b.itemConfig.type=b.itemConfig.type||"list",b.$watch("columns",function(a){a&&(b.itemConfig.columns=a)}),a.populateScope(b,c,d)}],templateUrl:a.template,replace:!0}}])}(),function(){a.module("oui.collection.mixed",["oui-templates-collection","oui.collection.list","oui.collection.tiles"]).directive("ouiMixedCollection",function(){return{restrict:"AE",scope:{config:"=?ouiMixedCollection",columns:"=?",tileConfig:"=?tileConfig",lineConfig:"=?lineConfig",absoluteItems:"=?",data:"=?",nbSelected:"=?",selectedIds:"=?",listController:"=?ouiMixedController",view:"=?",cartController:"=?cartController",loading:"=?loading",sort:"=?sort",filter:"=?filter",page:"=?",pageCount:"=?"},controller:["$scope","$element","$attrs","$_ouiCollection_obj_data","$_ouiCollection_obj_ctrl",function(a,b,c,d,e){a.limitWatchers="undefined"!=typeof c.limitWatchers&&"false"!==c.limitWatchers,a.ngMode=!a.limitWatchers,a.selectedIds=a.selectedIds||{},a.mixedController={};var f="boolean"==typeof a.limitWatchers?!a.limitWatchers:!("undefined"!=typeof c.limitWatchers&&"false"!==c.limitWatchers);a.colData=d(a,f),a.listController=e(a.colData)}],templateUrl:"oui-collection/mixed/mixed.tpl.html",replace:!0}})}(),function(){a.module("oui.collection.service",["oui-templates-collection","oo.stringsUtils","oui.services.loadingImg","oui.tooltip","ngSanitize","dateParser","lrInfiniteScroll"])}(),function(b){var c=function(a){return"function"==typeof a?a.apply(b,[].slice.call(arguments,1)):a&&a.toString()};a.module("oui.collection.service").factory("$ouiCollection",["$sce","$timeout","$_ouiCollection_col_types","$_ouiCollection_html_gen","$_ouiCollection_tpl_items","$_ouiCollection_tpl_chunks","$_ouiCollection_obj_data","$_ouiCollection_obj_html","$_ouiCollection_obj_ctrl",function(a,b,d,e,f,g,h,i,j){var k=e,l=d.types,m=f,n=g,o={};return o.template="oui-collection/service/collection.tpl.html",o.getSingleElementHtml=function(a,b,c){var d=["oo-collection"];l[c.collectionType||"tiles"].cls&&d.push(l[c.collectionType||"tiles"].cls),c.config&&c.config.cls&&d.push(c.config.cls);var e=["oo-collection-item-outer oo-collection-item-outer-dummy oui-before"],f=k.getItemOuterClass(null,null,c.itemConfig);return f&&e.push(f),['<div class="',d.join(" "),'">','<div class="oo-collection-inner">','<div class="oo-collection-width oui-before"></div>','<div class="',e.join(" "),'" ','style="',k.getItemOuterStyle(c.itemConfig),'">',k.getItemHtml(null,null,c.itemConfig,c.absoluteItems,{}),"</div>",k.getItemOuterHtml(a,b,c.itemConfig,c.absoluteItems,{}),"</div>","</div>"].join("")},o.resizeSingleElement=function(a,b){a.is(".oo-collection")||(a=a.find(".oo-collection")),a.length&&l[b.collectionType||"tiles"].onResize(a.first(),b.itemConfig,{})},o.populateScope=function(d,e,f){var g=e.closest(".oui-mixed-collection").last().isolateScope(),o="boolean"==typeof d.limitWatchers?!d.limitWatchers:!("undefined"!=typeof f.limitWatchers&&"false"!==f.limitWatchers),p=d.colData=g&&g.colData||h(d,o),q=i(d,p,e);if(d.listController=g&&g.listController||j(p),d.listController.registerHtmlUpdater(q),d.callChunkFn=function(a,b,c,e){var f=p.findCompleteDataFromId(b),g=m.getItemTpl(d.itemConfig);if(g&&g.getChunkCfgFromId){var h=g.getChunkCfgFromId(d.itemConfig,c);return h[a](f.data,f.misc,e)||""}return""},d.callAbsFn=function(a,b,c,e){var f=p.findCompleteDataFromId(b),g=d.absoluteItems[c];return g[a](f.data,f.misc,e)||""},d.getCollectionClass=function(){var a=[];return l[d.collectionType].cls&&a.push(l[d.collectionType].cls),p.config&&p.config.cls&&a.push(p.config.cls),a.join(" ")},d.getItemOuterClass=function(a){return k.getItemOuterClass(a&&a.data,a&&a.misc,d.itemConfig)},d.getItemOuterStyle=function(){return k.getItemOuterStyle(d.itemConfig)},d.getLoadingImgPath=function(){var a=m.getItemTpl(d.itemConfig),b=d.itemConfig.loadingImgPath||a.loadingImgPath;return c(b,p.getConfigValue("loadingColor"))},d.getItemHtml=function(b){return a.trustAsHtml(k.getItemHtml(b&&b.data,b&&b.misc,d.itemConfig,d.absoluteItems,q))},d.$on("$collection_endLoading",function(){b(function(){q.scrollToTop()})}),p.ngMode)d.$on("$collection_dataUpdated",function(){b(function(){q.scrollToTop(),q.resizeChunks()})}),d.$on("$collection_pageUpdated",function(){b(function(){q.scrollToTop()})});else{var r=null,s=!1,t=!1,u=-1,v=function(a,c,d){d=d||0,s=s||a,t=t||c,u=-1===u?d:Math.min(u,d),r&&b.cancel(r),r=b(function(){t&&q.scrollToTop(),q.updateListHtml(s,d),q.resizeChunks(),s=!1,t=!1,u=-1})};d.$on("$collection_updateList",function(a,b,c,d){v(!!b,!!c,d||0)}),d.$on("$collection_updateElt",function(a,b){q.updateEltHtml(b)}),d.$on("$collection_dataUpdated",function(){v(!0,!0)}),d.$on("$collection_pageUpdated",function(){v(!0,!0)}),d.$on("$collection_selectionUpdated",function(){q.updateSelectedState()}),d.$on("$collection_sortUpdated",function(){v(!1,!0)}),d.$on("$collection_filterUpdated",function(){v(!1,!0)}),d.$on("$collection_emptyList",function(){q.emptyList()}),d.$on("$langChange",function(){q.updateListHtml(!0,!1)})}e.on("click","[oui-list-item-id]",function(a){if(!p.$scope.loading){var b,c=$(this).attr("oui-list-item-id"),f=$(a.target),g=$(this),h=p.findCompleteDataFromId(c);if(f.is(".oo-collection-item-abs, .oo-collection-item-abs *")){var i=f.closest("[oui-abs]"),j=i.length?d.absoluteItems[i.attr("oui-abs")]:null;b=!1,!b&&p.config.onAbsClick&&d.$apply(function(){b=p.config.onAbsClick(h.data,h.misc,f,g,j,i)}),!b&&j.onClick&&d.$apply(function(){b=j.onClick(h.data,h.misc,g,j,i)}),!b&&p.isClickable(h.data)&&p.config.onClick&&d.$apply(function(){b=p.config.onClick(h.data,h.misc,g,j,i)})}else{var k=f.closest("[oui-chunk]"),l=null,o=null;if(k.length){var q=m.getItemTpl(d.itemConfig);q&&q.getChunkCfgFromId&&(l=q.getChunkCfgFromId.call(q,d.itemConfig,k.attr("oui-chunk")),o=l&&n.getChunkTpl(l))}if(b=!1,!b&&l&&l.onClick&&d.$apply(function(){b=l.onClick(h.data,h.misc,g,l,k,f)}),!b&&o&&o.onClick&&d.$apply(function(){b=o.onClick(h.data,h.misc,g,l,k,f)}),!b&&p.isClickable(h.data)&&p.config.onClick&&d.$apply(function(){b=p.config.onClick(h.data,h.misc,g,l,k)}),!b&&p.isSelectable(h.data)){var r=!p.isSelected(h.data);p.setSelected(h.data,h.misc,r),p.ngMode||(d.config.singleSelect&&e.find(".oo-collection-item.oo-selected").removeClass("oo-selected"),g.toggleClass("oo-selected",r)),d.$apply(function(){p.nbSelected=p.nbSelected+(r?1:-1),p.config.onSelect&&p.config.onSelect(r,h.data,h.misc,g)})}}}});var w=null,x=null,y=null,z=null,A=function(){w&&clearTimeout(w),x&&e.off("resize",x),w=null,x=null;var a=d.collectionType&&l[d.collectionType];if(a&&a.onResize){var b=0,c=0,f=function(){var f=d.loading?0:e.width(),g=d.loading?0:a.getTileWidth(e);e.is(":visible")&&f&&(0===b||f!==b||0===c||g!==c)&&(a.onResize.call(a,e,d.itemConfig,q),b=f,c=g,w=null)};q.setResizeChunksFn(f),f(),w=setTimeout(f,1);var g=0;x=function(a,b){w&&clearTimeout(w),e.is(":visible")&&b&&(0===g||g!==b)&&(g=b,w=setTimeout(f,100))},e.on("resize",x),e.find(".oo-collection-width").on("resize",x),y&&y(),y=d.$watch(function(){return e.find(".oo-collection-inner").is(":visible")},function(a){a&&f()}),z&&z(),z=d.$watch("data",function(a,b){setTimeout(function(){a&&a.length&&(!b||!b.length)&&f()},1)})}};d.$watch("collectionType",A),d.$watchCollection("itemConfig",A)},o}])}(),function(){var b=null,c={tiles:{cls:"oo-tiles",getTileWidth:function(a){return a.find(".oo-collection-item-outer-dummy .oo-collection-item-inner").width()},onResize:function(a,c,d){var e=a.find(".oo-collection-item-outer-dummy .oo-collection-item-inner").first(),f=e.width(),g=b.getItemTpl(c);g.onResize(a,c,f,d||{})}},list:{cls:"oo-list",getTileWidth:function(a){return a.find(".oo-collection-width").width()},onResize:function(a,c,d){var e=a.find(".oo-collection-width").width(),f=parseFloat(a.find(".oo-collection-item-outer").css("margin-left"),10)+parseFloat(a.find(".oo-collection-item-outer").css("margin-right"),10),g=parseFloat(a.find(".oo-collection-item").css("padding-left"),10)+parseFloat(a.find(".oo-collection-item").css("padding-right"),10),h=b.getItemTpl(c);h.onResize(a,c,e-f-g,d||{})}}};a.module("oui.collection.service").factory("$_ouiCollection_col_types",["$_ouiCollection_tpl_items",function(a){return b=a,{types:c}}])}(),function(){var b=null,c=null,d=null,e=function(a,b,c){return a?c.renderer?c.renderer.call(null,c,a,b):c.html?c.html:"":""},f=function(a,b,c){var e=[];return c.cls&&e.push(d.strOrFuncNormalize(c.cls,c,a,b)),e.join(" ")},g=function(b){var c={};return b.style&&a.extend(c,b.style),d.addToStyleIfDefined(c,b,["width","minWidth","maxWidth","height","minHeight","maxHeight","top","left","right","bottom"]),c},h=function(a,c,h,i){var j=[],k=["oo-collection-item-abs"],l=f(a,c,h),m=d.styleObjToString(g(h));return l&&k.push(l),j.push('<div class="',k.join(" "),'"',m?' style="'+m+'"':"","undefined"!=typeof i?' oui-abs="'+i+'" ':" ",b.getTooltipAttributes(a,c,h,null,null,i),">",e(a,c,h),"</div>"),j.join("")},i=function(b){var d={},e=c.getItemTpl(b);return e&&e.style&&a.extend({},e.style),b&&b.style&&a.extend({},b.style),d},j=function(a,b,e){var f=[],g=c.getItemTpl(e);return g&&g.cls&&f.push(g.cls),e&&e.cls&&f.push(d.strOrFuncNormalize(e.cls,e,a,b)),f.join(" ")},k=function(a,b,e,f,g){var k=[],l=c.getItemTpl(e),m=["oo-collection-item"],n=j(a,b,e),o=d.styleObjToString(i(e));return n&&m.push(n),g&&g.colData&&(g.colData.isSelected&&g.colData.isSelected(a)&&m.push("oo-selected"),g.colData.isSelectable&&g.colData.isSelectable(a)&&m.push("oo-selectable"),g.colData.isClickable&&g.colData.isClickable(a)&&m.push("oo-clickable")),k.push('<div class="',m.join(" "),'"',o?' style="'+o+'"':"",' oui-list-item-id="',d.getUniqueId(a),'">','<div class="oo-collection-item-inner">'),k.push(l.renderer.call(l,a,b,e,g||{})),k.push("</div>"),f&&$.each(f,function(c,d){k.push(h(a,b,d,c))}),k.push("</div>"),k.join("")},l=function(a){var b={},e=c.getItemTpl(a);return e&&d.addToStyleIfDefined(b,e,["width","height"]),a&&d.addToStyleIfDefined(b,a,["width","height"]),b},m=function(a,b,e){var f,g=[],h=c.getItemTpl(e);return h&&h.cls&&g.push(h.cls+"-outer"),e&&e.cls&&(f=d.strOrFuncNormalize(e.cls,e,a,b),f&&g.push(f.trim().replace(/(\s+|$)/g,"-outer$1"))),a&&a.hidden&&g.push("oo-hidden"),g.join(" ")},n=function(a,b,c,e,f){var g=[],h=["oo-collection-item-outer"],i=m(a,b,c),j=d.styleObjToString(l(c));return i&&h.push(i),g.push('<div class="',h.join(" "),'"',j?' style="'+j+'"':"",">",k(a,b,c,e,f||{}),"</div>"),g.join("")};a.module("oui.collection.service").factory("$_ouiCollection_html_gen",["$_ouiCollection_html_gen_tooltip","$_ouiCollection_tpl_items","$_ouiCollection_tools",function(a,e,f){return b=a,c=e,d=f,{getItemOuterHtml:n,getItemOuterClass:m,getItemOuterStyle:l,getItemHtml:k}}])}(),function(){var b=null,c=null,d=null,e=null,f=function(a,d,e,f){var g=null;return e.type&&(g=b.getChunkTpl(e),!g)?"ERR":c.getInnerHtmlFromCfgOrTpl(a,d,e,f,g)},g=function(a,c,d){var f=null,g=[];return d.type&&(f=b.getChunkTpl(d),!f)?"ERR":(a=a||{},c=c||{},f&&f.cls&&g.push("function"==typeof f.cls?f.cls.call(f,d,a,c):f.cls),f&&f.cls&&g.push(e.strOrFuncNormalizeScoped(f.cls,f,d,a,c)),d.cls&&g.push(e.strOrFuncNormalize(d.cls,d,a,c)),g.join(" "))},h=function(c,d){var f=null,g={};return c.type&&(f=b.getChunkTpl(c),!f)?null:(f&&f.style&&a.extend(g,f.style),c.style&&a.extend(g,c.style),f&&e.addToStyleIfDefined(g,f,["width","minWidth","maxWidth"]),e.addToStyleIfDefined(g,c,["width","minWidth","maxWidth"]),d&&(g.width=d),g.width&&(delete g.minWidth,delete g.maxWidth),g)},i=function(a,c,i,j,k){var l=[],m=b.getChunkTpl(i),n="oo-collection-item-chunk",o=[n],p=g(a,c,i),q=e.styleObjToString(h(i,k)),r=null;return p&&o.push(p),l.push('<div class="',o.join(" "),'"',q?' style="'+q+'"':"","undefined"!=typeof j?' oui-chunk="'+j+'"':"",">",'<div class="',n,'-inner"',r?' style="'+r+'"':"",d.getTooltipAttributes(a,c,i,j,m),">",f(a,c,i,j),"</div>","</div>"),l.join("")};a.module("oui.collection.service").factory("$_ouiCollection_html_gen_chunk",["$sanitize","$filter","$dateParser","$_ouiCollection_tpl_chunks","$_ouiCollection_html_gen_chunk_inner","$_ouiCollection_html_gen_tooltip","$_ouiCollection_tools",function(a,f,g,h,j,k,l){return b=h,c=j,d=k,e=l,{getChunkHtml:i}}])}(),function(b){function c(a,b){if("date"===b.type){if("string"==typeof a){var c=a;a=i(c,"yyyy-MM-ddTHH:mm:ss"),(!a||isNaN(a.getTime()))&&(a=i(c,"yyyy-MM-ddTHH:mm:ssZ"))}else"number"==typeof a&&(a=new Date(a));return h("date")(a,b.format||"medium")}return a}function d(a,b,e){return"object"==typeof e?c(d(a,b,e.value),e):j.strOrFuncNormalize(e,a,b)}function e(a,b,d){return"object"==typeof d?c(e(a,b,d.field),d):a[j.strOrFuncNormalize(d,a,b)]}function f(c){var d,e;if(!c)return function(a){return a};for(c=a.isArray(c)?a.copy(c):c.split(/[|,;\s]+/),d=0;d<c.length;++d)e=c[d],a.isArray(e)||(c[d]=(e&&e.toString?e.toString():"").split(":")),c[d]={name:c[d][0],args:c[d]};return function(d){return a.forEach(c,function(a){a.args[0]=d,d=h(a.name).apply(b,a.args)}),d}}function g(a,b,c,g,i,l,m){if(!a)return"";var n,o,p,q=null;if(!l&&"object"==typeof c&&c.renderer)return c.renderer.call(null,c,a,b,g);if(!l&&i&&"object"==typeof i&&i.renderer)return i.renderer.call(i,c,a,b,g);if(l||"object"==typeof c){if(!l&&c.html)return j.strOrFuncNormalize(c.html,a,b);if(c.value)q=d(a,b,c.value);else if(c.field)q=e(a,b,c.field);else if(l||"object"==typeof i){if(!l&&i&&i.html)return j.strOrFuncNormalizeScoped(i.html,i,a,b);i&&i.value?q=d(a,b,i.value):i&&i.field&&(q=e(a,b,i.field))}else q="function"==typeof c?c(a,b):a[c]}else q="function"==typeof c?c(a,b):a[c];return p=f(c.filters||(m!==!1?k:[])),"object"==typeof c&&c.highlight?(o=j.strOrFuncNormalize(c.highlight,a,b),n=o?h("searchWithDiacritics")(q,o,{ignoreCase:!0},p,'match:strProcess:<span class="oo-collection-chunk-highlight">$&</span>'):p(q)):n=p(q),n=m!==!1?j.sanitize(n):n,n||""}var h=null,i=null,j=null,k=["escapeHtml"];a.module("oui.collection.service").factory("$_ouiCollection_html_gen_chunk_inner",["$filter","$dateParser","$_ouiCollection_tools",function(a,b,c){return h=a,i=b,j=c,{getInnerHtmlFromCfgOrTpl:g}}])}(),function(){var b=null,c=null,d=function(d,e,f,g,h,i){var j,k;if(f.tooltip){if(a.isObject(f.tooltip)){k=[];for(var l in f.tooltip)"boolean"==typeof f.tooltip[l]?typeof f.tooltip[l]===!0&&k.push("oui-tooltip-"+l):"cfg"===l?k.push("oui-tooltip-"+l+'="'+a.toJson(f.tooltip[l]).replace(/\"/g,"&quot;")+'"'):"text"===l?(j=b.getInnerHtmlFromCfgOrTpl(d,e,f.tooltip[l],g,null,!1),j&&k.push("oui-tooltip-"+l+'="'+j.replace(/\"/g,"&quot;")+'"')):"colExprFn"===l?k.push(a.isDefined(i)&&null!==i?"oui-tooltip-expr=\".oo-collection:i:callAbsFn('"+f.tooltip[l]+"', '"+c.getUniqueId(d)+"', '"+i+"', overflow)\"":"oui-tooltip-expr=\".oo-collection:i:callChunkFn('"+f.tooltip[l]+"', '"+c.getUniqueId(d)+"', '"+g+"', overflow)\""):(j=c.strOrFuncNormalize(f.tooltip[l],d,e),j&&k.push("oui-tooltip-"+l+'="'+j.replace(/\"/g,"&quot;")+'"'));return k.join(" ")}var m=b.getInnerHtmlFromCfgOrTpl(d,e,f.tooltip,g,null,!1);if(m)return'oui-tooltip-text="'+m.replace(/\"/g,"&quot;")+'"'}else if("undefined"!=typeof f.ellipsis?!!f.ellipsis:h?!!h.ellipsis:!1)return"oui-tooltip-overflow";return""};a.module("oui.collection.service").factory("$_ouiCollection_html_gen_tooltip",["$_ouiCollection_html_gen_chunk_inner","$_ouiCollection_tools",function(a,e){return b=a,c=e,{getTooltipAttributes:d}}])}(),function(){var b=function(a){this.colData=a,this.htmlUpdaters=[]};b.prototype.registerHtmlUpdater=function(a){this.htmlUpdaters.push(a)},b.prototype.updateList=function(){this.colData.updateList()},b.prototype.getDataFromUniqueId=function(a){var b=this.colData.findCompleteDataFromId(a);return b?b.data:void 0},b.prototype.getMisc=function(a){var b=this.colData.findCompleteDataFromId(this.colData.getUniqueIdFromData(a));return b?b.misc:void 0},b.prototype.addItem=function(a,b,c){!c&&this.colData.disableEvents(),this.colData.addItem(a,b,c),!c&&this.colData.enableEvents()},b.prototype.updateItem=function(a,b,c){!c&&this.colData.disableEvents(),this.colData.updateItem(a,b),!c&&this.colData.enableEvents()},b.prototype.removeItem=function(a,b){!b&&this.colData.disableEvents(),this.colData.removeItem(a),!b&&this.colData.enableEvents()},b.prototype.emptyList=function(){this.colData.emptyList()},b.prototype.countItems=function(){return this.colData.countItems()},b.prototype.isInList=function(a){return this.colData.isInList(a)},b.prototype.isLoadingDisplayed=function(){return this.colData.isLoadingDisplayed()},b.prototype.isDataDisplayed=function(a){return this.colData.isDataDisplayed(a)},b.prototype.isEmptyDisplayed=function(){return this.colData.isEmptyDisplayed()},b.prototype.getSelection=function(){return this.colData.getCompleteDataSelection()},b.prototype.getItems=function(){return this.colData.getCompleteDataCopy()},b.prototype.getItemId=function(){return this.colData.getFirstItemId()},b.prototype.getItemElts=function(a){var b,c=this,d=[];return $.each(this.htmlUpdaters,function(e,f){b=f.htmlData&&f.htmlData[c.colData.getUniqueIdFromData(a)],b&&b._el&&d.push(b._el[0])}),$(d)},a.module("oui.collection.service").factory("$_ouiCollection_obj_ctrl",function(){return function(a){return new b(a)}})}(),function(){function b(b,c,f){this.$scope=b,this.ngMode=c,a.extend(this,{nbVisible:0,nbSelected:0,completeData:[],pageData:[],eltsMap:{}}),this.config=this.$scope.config,this.eventsDisabled=!1,this.paging={strategy:this.getConfigValue("pagingStrategy"),pageSize:this.getConfigValue("pageSize"),count:this.getConfigValue("pageSize")},this.lazy={scrollThreshold:this.getConfigValue("lazyScrollThreshold"),timeThreshold:this.getConfigValue("lazyTimeThreshold")||(this.paging.strategy?d:e)},a.extend(this,f),this.updateData(this.getData()),this.computePageData(),this._initEvents()}var c={emptyText:"i18n:oui.collection.empty",filteredEmptyText:"i18n:oui.collection.filtered.empty",loadingText:"i18n:common.loading_long_susp",loadingColor:"black",pagingStrategy:null,pageSize:50,lazyScrollThreshold:200,lazyTimeThreshold:null},d=100,e=400,f={uc:function(a){return a?a.toUpperCase():a},lc:function(a){return a?a.toLowerCase():a},dc:function(a){return g("removeDiacritics")(a)}},g=null,h=null,i=null,j=null;b.prototype._initEvents=function(){var a=this,b=this,c=this.$scope,d=null;if(c.$watch("loading",function(e){d&&h.cancel(d),d=null,"number"==typeof e?e>=0?h(function(){c.loading&&(c.loading=!0)},e):h(function(){c.loading&&(c.loading=!1)},-1*e):e===!0?a.emptyList():(c.loading=!1,b.broadcastEvent("$collection_endLoading"))}),this.onInfiniteScroll=function(){a.handleInfiniteScroll()},a.ngMode)c.$watchCollection("data",function(){h(function(){a.updateListFromData()})}),c.$watch("page",function(){h(function(){a.computePageData(),b.broadcastEvent("$collection_pageUpdated")})}),c.$watchCollection("sort",function(){h(function(){a.sortData(),a.computePageData(),b.broadcastEvent("$collection_sortUpdated")})}),c.$watchCollection("filter",function(){h(function(){a.filterData(),a.computePageData(),b.broadcastEvent("$collection_filterUpdated")})});else{c.$watch("data",function(){a.updateListFromData()}),c.$watch("page",function(){a.computePageData(),b.broadcastEvent("$collection_pageUpdated")}),c.$watchCollection("selectedIds",function(){b.broadcastEvent("$collection_selectionUpdated")}),c.$watchCollection("sort",function(){a.sortData(),a.computePageData(),b.broadcastEvent("$collection_sortUpdated")}),c.$watchCollection("filter",function(){a.filterData(),a.computePageData(),b.broadcastEvent("$collection_filterUpdated")}),c.$on("$destroy",function(){a.emptyList()});var e=c.$watch("cartController",function(){c.$watch(function(){return c.config.singleSelect?c.cartController&&c.cartController.getItemId():c.cartController?c.cartController.countItems():0},function(){b.broadcastEvent("$collection_selectionUpdated")}),e()})}},b.prototype.disableEvents=function(){this.eventsDisabled=!0},b.prototype.enableEvents=function(){this.eventsDisabled=!1},b.prototype.broadcastEvent=function(){!this.eventsDisabled&&this.$scope.$broadcast.apply(this.$scope,[].slice.call(arguments,0))},b.prototype.isLoadingDisplayed=function(){return this.$scope.loading===!0||"number"==typeof this.$scope.loading&&this.$scope.loading<0},b.prototype.isDataDisplayed=function(a){return(!a||this.nbVisible)&&!this.isLoadingDisplayed()},b.prototype.isEmptyDisplayed=function(){return!this.isDataDisplayed(!0)&&this.isDataDisplayed(!1)},b.prototype.getConfigValue=function(a){return this.config&&this.config[a]||c[a]},b.prototype.getPageCount=function(){return this.$scope.pageCount},b.prototype.getPage=function(){return this.$scope.page},b.prototype.updateData=function(a){this.$scope.data=a||[]},b.prototype.getData=function(){return this.$scope.data},b.prototype.getUniqueIdFromData=function(a){return this.config&&this.config.id?"function"==typeof this.config.id?this.config.id(a):a[this.config.id]:a.id},b.prototype.isSelected=function(a){return a&&(this.$scope.cartController?this.$scope.cartController.isInList(a):this.$scope.selectedIds&&!!this.$scope.selectedIds[a._id])},b.prototype.setSelected=function(a,b,c){this.$scope.cartController?(this.config.singleSelect&&this.$scope.cartController.emptyList(),c?this.$scope.cartController.addItem(a,b):this.config.singleSelect||this.$scope.cartController.removeItem(a)):(this.$scope.selectedIds=this.config.singleSelect?{}:this.$scope.selectedIds||{},c?this.$scope.selectedIds[a._id]=!0:this.config.singleSelect||delete this.$scope.selectedIds[a._id])},b.prototype.isSelectable=function(a){return this.config&&a?"function"==typeof this.config.selectable?this.config.selectable(a):"string"==typeof this.config.selectable?a[this.config.selectable]:this.config.selectable:!1},b.prototype.isClickable=function(a){return this.config&&a?"function"==typeof this.config.clickable?this.config.clickable(a):"string"==typeof this.config.clickable?a[this.config.clickable]:this.config.clickable:!1},b.prototype.computePageData=function(){var a,b,c,d=this,e=this.paging;this.$scope.pageCount=Math.max(1,Math.floor((this.nbVisible+this.paging.pageSize-1)/this.paging.pageSize)),this.$scope.page>=this.$scope.pageCount&&(this.$scope.page=this.$scope.pageCount-1),this.ngMode&&(this.pageData=[],a=this.getPage(),b=0,$.each(this.completeData,function(f,g){c=b,g.hidden||(b++,"paged"===e.strategy&&(c<a*e.pageSize||c>=(a+1)*e.pageSize)||"lazy"===e.strategy&&c>=e.count||d.pageData.push(g))}))};var k=function(a,b,c){if(!a||!a[b])return function(){return 0};var d,e,g,h,i=a[b];return"string"==typeof i?(d=i.split(":"),e=function(a){for(var b=1;b<d.length;++b)f[d[b]]&&(a=f[d[b]](a));return a},g=d[0],h=-1!==d.indexOf("emptyLast"),function(a,b){return a=e(a.data[g])||"",b=e(b.data[g])||"",!h||a===b||a&&b?(c?1:-1)*(a>b?1:b>a?-1:0):(c?1:-1)*(a?-1:1)}):"function"==typeof i?function(a,b){return(c?1:-1)*i(a.data,b.data)}:void 0};b.prototype.sortData=function(){return this.paging.count=this.getConfigValue("pageSize"),this.$scope.sort&&this.completeData?(this.completeData.sort(k(this.config.sorts,this.$scope.sort.name,this.$scope.sort.asc)),!0):!1},b.prototype.filterData=function(){var a=this;return this.paging.count=this.getConfigValue("pageSize"),this.nbVisible=0,this.completeData?($.each(this.completeData,function(b,c){c.hidden=a.$scope.filter&&!a.$scope.filter(c.data,c.misc),!c.hidden&&a.nbVisible++}),!0):!1},b.prototype.findDataFromId=function(a){var b=this.eltsMap[a];return b&&b.data},b.prototype.findCompleteDataFromId=function(a){return this.eltsMap[a]},b.prototype.addItems=function(b,c){if(b=a.isArray(b)?b:[b],!b.length)return null;var d=[],e=this;return $.each(b,function(a,b){var f=c?b.data:b,g=c?b.misc||{}:{},h=e.getUniqueIdFromData(f);f._id=f._id||h;var i=e.findCompleteDataFromId(h);i?(i.data=f,i.misc=g):(i=e.eltsMap[h]={_id:h,data:f,misc:g},e.$scope.data.push(f),e.completeData.push(i)),d.push(i)}),this.sortData(),this.filterData(),this.computePageData(),this.broadcastEvent("$collection_updateList",!0),d},b.prototype.addItem=function(a,b){return this.addItems({data:a,misc:b},!0)[0]},b.prototype.updateItems=function(b,c){if(b=a.isArray(b)?b:[b],!b.length)return null;var d=[],e=this;return $.each(b,function(a,b){var f=c?b.data:b,g=c?b.misc||{}:{},h=e.findCompleteDataFromId(e.getUniqueIdFromData(f));h&&(f._id=f._id||e.getUniqueIdFromData(f),h.data=f,h.misc=g,d.push(h))}),d.length&&(this.sortData(),this.filterData(),this.computePageData(),$.each(d,function(a,b){e.broadcastEvent("$collection_updateElt",b)})),d},b.prototype.updateItem=function(a,b){return this.updateItems({data:a,misc:b},!0)[0]},b.prototype.removeItems=function(b,c){if(b=a.isArray(b)?b:[b],!b.length)return null;var d=0,e=this;return $.each(b,function(a,b){var f,g=c?b.data:b,h=e.getUniqueIdFromData(g),i=e.eltsMap[h];i&&(delete e.eltsMap[h],f=e.$scope.data.indexOf(i.data),-1!==f&&e.$scope.data.splice(f,1),f=e.completeData.indexOf(i),-1!==f&&e.completeData.splice(f,1),d++)}),d?(this.computePageData(),this.broadcastEvent("$collection_updateList",!0),!0):!1},b.prototype.removeItem=function(a){return this.removeItems({data:a},!0)},b.prototype.emptyList=function(){this.nbVisible=0,this.$scope.data=[],this.completeData=[],this.eltsMap={},this.pageData=[],this.computePageData(),this.broadcastEvent("$collection_emptyList")},b.prototype.countItems=function(){return this.completeData.length},b.prototype.isInList=function(a){return!!this.findCompleteDataFromId(this.getUniqueIdFromData(a))},b.prototype.updateList=function(){this.broadcastEvent("$collection_updateList",!0)},b.prototype.updateListFromData=function(){var a=this,b=this.$scope.selectedIds||{},c=this.eltsMap;this.nbVisible=0,this.completeData=[],this.eltsMap={},this.pageData=[],this.$scope.selectedIds={},this.nbSelected=0,this.$scope.data&&$.each(this.$scope.data,function(d,e){e._id=e._id||a.getUniqueIdFromData(e);var f=a.eltsMap[e._id]={_id:e._id,data:e,misc:a.$scope.cartController&&a.$scope.cartController.getMisc(e)||c[e._id]&&c[e._id].misc||{}};a.completeData.push(f),b[e._id]&&a.config.conserveSelection!==!1&&(a.$scope.selectedIds[e._id]=!0,a.nbSelected++)}),this.sortData(),this.filterData(),this.computePageData(),this.broadcastEvent("$collection_dataUpdated")},b.prototype.getFirstItemId=function(){return this.completeData.length?j.getUniqueId(this.completeData[0]):null},b.prototype.getCompleteDataSelection=function(){var a,b=[];for(var c in this.$scope.selectedIds)a=this.eltsMap[c],b.push({id:c,data:a.data,misc:a.misc});return b},b.prototype.getCompleteDataCopy=function(){var a=[];return $.each(this.completeData,function(b,c){a.push({id:j.getUniqueId(c),data:c.data,misc:c.misc})
}),a},b.prototype.handleInfiniteScroll=function(){var b,c,d=this,e=this.paging;if(this.completeData)if("lazy"===e.strategy){for(b=0,c=0;c<this.completeData.length&&b<e.count;++c){var f=this.completeData[c];f.hidden||b++}e.count<this.nbVisible&&(e.count+=e.pageSize,this.computePageData(),d.broadcastEvent("$collection_updateList",!1,!1,c))}else this.config.onInfiniteScroll&&i.when(this.config.onInfiniteScroll(this.completeData.length)).then(function(b){if(b===!0)d.broadcastEvent("$collection_updateList",!0,!1);else{var c=!1;if(a.isObject(b)&&b.data&&(c=!!b.withMisc,b=b.data),b&&a.isArray(b)){var e=d.completeData.length;d.addItems(b,!!c),d.broadcastEvent("$collection_updateList",!1,!1,e)}}})},a.module("oui.collection.service").factory("$_ouiCollection_obj_data",["$timeout","$filter","$q","$_ouiCollection_tools",function(a,c,d,e){return g=c,h=a,i=d,j=e,function(a,c,d){return new b(a,c,d)}}])}(),function(){function b(a,b,c){this.$scope=a,this.colData=b,this.$element=c,this.resizeChunksFn=null,this.internalData={},this.htmlData={}}var c=null;b.prototype.setResizeChunksFn=function(a){this.resizeChunksFn=a},b.prototype.resizeChunks=function(){this.resizeChunksFn&&this.resizeChunksFn()},b.prototype.getListContainer=function(){var a=this.listContainer||this.$element.find(".oo-collection-inner");return a.length&&(this.listContainer=a),this.listContainer},b.prototype.scrollToTop=function(){this.getListContainer().scrollTop(0)},b.prototype.updateListHtml=function(a,b){if(!this.colData.ngMode&&this.colData.completeData){var d,e,f,g,h,i,j,k,l=this,m=this.colData.completeData,n=this.getListContainer(),o=this.colData.paging,p=this.colData.getPage(),q=0,r=0;if(a)this.emptyList(),d=[n.html()],$.each(m,function(a,b){j=r,b.hidden||(r++,"paged"===o.strategy&&(j<p*o.pageSize||j>=(p+1)*o.pageSize)||"lazy"===o.strategy&&j>=o.count||(e=l.htmlData[b._id],e||(l.htmlData[b._id]=e={}),e.html=c.getItemOuterHtml(b.data,b.misc,l.$scope.itemConfig,l.$scope.absoluteItems,l),o.strategy?(e._el=$(e.html),n.append(e._el),e._itemEl=e._el.children().first()):d.push(e.html)))}),o.strategy||(n[0].innerHTML=d.join(""),n.children(":not(.oui-before)").each(function(a,b){k=$(b),i=m[a],e=l.htmlData[i._id],e||(l.htmlData[i._id]=e={}),e._el=k,e._itemEl=k.children().first()}));else{if(f=n.children(":not(.oo-hidden)").length,g=0,h=this.getListContainer().find(".oui-before").last(),b){for(q=0;q<m.length&&b>q;++q)m[q].hidden||r++;for(q=b-1;q>=0;--q)if(e=l.htmlData[m[q]._id]){h=e._el;break}}for(q=b||0;q<m.length;++q)if(i=m[q],j=r,e=l.htmlData[i._id],e||(l.htmlData[i._id]=e={}),i.hidden||r++,e._el){if("paged"===o.strategy&&(j<p*o.pageSize||j>=(p+1)*o.pageSize||i.hidden)){e._el.remove(),delete e._el,delete e._itemEl;continue}if("lazy"===o.strategy&&("lazy"===o.strategy&&j>=o.count||i.hidden)){e._el.remove(),delete e._el,delete e._itemEl;continue}e._el.toggleClass("oo-hidden",!!i.hidden),e._el.insertAfter(h),h=e._el}else{if(i.hidden)continue;if("paged"===o.strategy&&(j<p*o.pageSize||j>=(p+1)*o.pageSize))continue;if("lazy"===o.strategy&&j>=o.count)continue;e.html||(e.html=c.getItemOuterHtml(i.data,i.misc,l.$scope.itemConfig,l.$scope.absoluteItems,l)),k=$(e.html),k.insertAfter(h),e._el=k,e._itemEl=k.children().first(),h=e._el,g++}(g||n.children(":not(.oo-hidden)").length!==f)&&this.resizeChunks()}}},b.prototype.updateEltHtml=function(a){if(!this.colData.ngMode){var b,d,e=this.htmlData[a._id];e&&e._el&&(b=e._el,d=$(c.getItemOuterHtml(a.data,a.misc,this.$scope.itemConfig,this.$scope.absoluteItems,this)),e._el=d,e._itemEl=d.children().first(),b.replaceWith(d))}},b.prototype.emptyList=function(){var a=this.getListContainer();if(this.htmlData={},!this.colData.ngMode&&a&&a.length){var b=[];a.children(".oui-before").each(function(){b.push(this.outerHTML)}),a[0].innerHTML=b.join("")}},b.prototype.updateSelectedState=function(){var a,b=this;$.each(this.colData.completeData,function(c,d){a=b.htmlData[d._id],a&&a._itemEl&&a._itemEl.toggleClass("oo-selected",b.colData.isSelected(d.data))})},a.module("oui.collection.service").factory("$_ouiCollection_obj_html",["$_ouiCollection_html_gen",function(a){return c=a,function(a,c,d){return new b(a,c,d)}}])}(),function(b){function c(a,b){return"function"==typeof a?a.apply(b,[].slice.call(arguments,2)):a&&a.toString()}function d(a){return"function"==typeof a?a.apply(b,[].slice.call(arguments,1)):a&&a.toString()}function e(a,b,c){for(var d=0;d<c.length;++d)"undefined"!=typeof b[c[d]]&&(a[c[d]]=b[c[d]])}function f(a){if(a){var b="";for(var c in a)b+=c.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()+":"+a[c]+";";return b}return""}function g(a){return a?a._id:null}function h(a){return a&&"string"==typeof a?i(a):a||""}var i=null;a.module("oui.collection.service").factory("$_ouiCollection_tools",["$sanitize",function(a){return i=a,{strOrFuncNormalizeScoped:c,strOrFuncNormalize:d,addToStyleIfDefined:e,styleObjToString:f,getUniqueId:g,sanitize:h}}])}(),function(){var b=null,c=null,d=null,e=null,f={selcb:{isLocked:function(a,b,c){return a.locked?"function"==typeof a.locked?a.locked(b,c):b[a.locked]:!1},cls:function(a,b,c){var d=this.isLocked(a,b,c);return d?"oo-collection-item-chunk-cb oo-collection-item-chunk-cb-locked":a.smartshow?"oo-collection-item-chunk-cb oo-collection-item-chunk-cb-smarthidden":"oo-collection-item-chunk-cb"},renderer:function(a,c,d){var f=this.isLocked(a,c,d);if(f){var g=e.strOrFuncNormalize(a.lockTooltip,c);return'<i class="icon-lock"'+(g?' oui-tooltip-text="'+b("escapeHtml")(b("i18nOrText")(g))+'"':"")+"></i>"}return'<div class="oo-collection-item-cb"><i class="icon-check_on"></i></div><i class="icon-lock"></i>'},width:"3em"},icon:{isPerson:function(a,b){return!!e.strOrFuncNormalize(a.person,b)},cls:function(a,b){return this.isPerson(a,b)?"oo-collection-item-chunk-ico oo-collection-item-chunk-ico-person":a.iconName?"oo-collection-item-chunk-ico":"oo-collection-item-chunk-ico oo-collection-item-chunk-ico-img"},renderer:function(a,d,f,g){if(this.isPerson(a,d)){var h=c.getInnerHtmlFromCfgOrTpl(d,f,a.fullName,g,this.fullName,!1,!1),i=b("toInitials")(h,"",!0,3);return'<i class="icon-user"></i><span class="bn-initials">'+e.sanitize(i)+"</span>"}if(a.iconName)return'<i class="icon-'+e.strOrFuncNormalize(a.iconName,d)+'"></i>';var j=c.getInnerHtmlFromCfgOrTpl(d,f,a.path,g,!1,!1);return'<img src="'+j+'"/>'},width:"3.5em",fullName:"name"},bigIcon:{isPerson:function(a,b){return!!e.strOrFuncNormalize(a.person,b)},cls:function(a,b){return this.isPerson(a,b)?"oo-collection-item-chunk-ico-big oo-collection-item-chunk-ico-person":a.iconName?"oo-collection-item-chunk-ico-big":"oo-collection-item-chunk-ico-big oo-collection-item-chunk-ico-img"},renderer:function(a,d,f,g){if(this.isPerson(a,d)){var h=c.getInnerHtmlFromCfgOrTpl(d,f,a.fullName,g,this.fullName,!1,!1),i=b("toInitials")(h,"",!0,3);return'<i class="icon-user"></i><span class="bn-initials">'+e.sanitize(i)+"</span>"}if(a.iconName)return'<i class="icon-'+e.strOrFuncNormalize(a.iconName,d)+'"></i>';var j=c.getInnerHtmlFromCfgOrTpl(d,f,a.path,g,!1,!1);return'<img src="'+j+'"/>'},width:"5em",fullName:"name"},name:{cls:"oo-collection-item-chunk-name",field:"name",ellipsis:!0},nameAndText:{cls:"oo-collection-item-chunk-name-and-text",nameCfg:"name",textCfg:"text",renderer:function(a,b,e,f){var g=c.getInnerHtmlFromCfgOrTpl(b,e,a.nameCfg,f,this.nameCfg),h=c.getInnerHtmlFromCfgOrTpl(b,e,a.textCfg,f,this.textCfg);return'<div class="oo-name" '+d.getTooltipAttributes(b,e,a.nameCfg,f,{ellipsis:!0})+">"+g+'</div><div class="oo-text" '+d.getTooltipAttributes(b,e,a.textCfg,f,{ellipsis:!0})+">"+(h||"&nbsp;")+"</div>"},ellipsis:!0},text:{cls:"oo-collection-item-chunk-text",field:"text",ellipsis:!0},iconAndText:{cls:"oo-collection-item-chunk-icon-and-text",field:"text",renderer:function(a,b,d,f){var g=e.strOrFuncNormalize(a.iconName,b),h=c.getInnerHtmlFromCfgOrTpl(b,d,a,f,this,!0);return h?'<i class="icon-'+g+'"></i><span>'+h+"</span>":""},ellipsis:!0},actionIcon:{cls:"oo-collection-item-chunk-action-ico",renderer:function(a,c){var d=e.strOrFuncNormalize(a.iconName,c),f=e.strOrFuncNormalize(a.tooltip,c);return d?['<i class="icon-',d,'"',f?' oui-tooltip-text="'+b("escapeHtml")(b("i18nOrText")(f))+'"':"","></i>"].join(""):""},onClick:function(a,b,c,d,e,f){return f.is(".oo-collection-item-chunk-inner, .oo-collection-item-chunk-inner *")?d.onActionClick&&d.onActionClick(a,b,c,d,e):!1},width:"3.3em"},actionIcons:{cls:function(a){return"oo-collection-item-chunk-action-ico-list "+(a.vertical?"oo-vertical":"oo-horizontal")},renderer:function(a,b,c,f){for(var g=[],h=0;h<a.icons.length;++h){g.length&&a.vertical&&g.push("<p></p>");var i=e.strOrFuncNormalize(a.icons[h].iconName,b);i&&g.push('<i class="icon-',i,'" oui-ico-idx="',h,'"',d.getTooltipAttributes(b,c,a.icons[h].tooltip,f),"></i>")}return g.join("")},onClick:function(a,b,c,d,e,f){if(f.is(".oo-collection-item-chunk-inner, .oo-collection-item-chunk-inner [oui-ico-idx]")){var g=d.icons[parseInt(f.attr("oui-ico-idx"),10)];return g&&g.onActionClick&&g.onActionClick(a,b,c,g,f)}return!1},width:"3.3em"}};a.module("oui.collection.service").factory("$_ouiCollection_tpl_chunks",["$filter","$_ouiCollection_html_gen_chunk_inner","$_ouiCollection_html_gen_tooltip","$_ouiCollection_tools",function(a,g,h,i){return b=a,c=g,d=h,e=i,{templates:f,getChunkTpl:function(a){return a&&a.type?f[a.type]:null}}}])}(),function(){var b=null,c=null,d=null,e={classic:{cls:"oo-collection-item-classic",cb:{type:"selcb"},icon:{type:"bigIcon"},name:{type:"name",field:"name"},createColumn:function(a){return'<div class="oo-collection-item-col">'+a+"</div>"},renderer:function(b,c,e,f){var g=[],h=f.internalData||{},i=e.cb===!0?this.cb:e.cb===!1?null:e.cb,j=e.footer||this.footer;if(g.push('<div class="oo-collection-item-classic-main',j?" oo-collection-item-classic-main-with-footer":"",'">','<div class="oo-collection-item-classic-main-inner">',i?this.createColumn(d.getChunkHtml(b,c,i,"cb")):"",this.createColumn(d.getChunkHtml(b,c,e.icon||this.icon,"icon")),this.createColumn(d.getChunkHtml(b,c,e.name||this.name,"name",h.nameWidth)),e.rightAction?this.createColumn(d.getChunkHtml(b,c,e.rightAction,"rightAction")):"","</div>","</div>"),j&&j.length){g.push('<div class="oo-collection-item-classic-footer">','<div class="oo-collection-item-classic-footer-inner">'),j=a.isArray(j)?j:[j];for(var k=0;k<j.length;++k)g.push(this.createColumn(d.getChunkHtml(b,c,j[k],"footer_"+k,h.footersWidth&&h.footersWidth[k])));g.push("</div>","</div>")}return g.join("")},getChunkCfgFromId:function(a,b){switch(b){case"cb":return a.cb===!0?this.cb:a.cb===!1?null:a.cb;case"icon":return a.icon||this.icon;case"name":return a.name||this.name;case"rightAction":return a.rightAction}return"footer_"===b.substring(0,7)?a.footer&&a.footer[parseInt(b.substring(7),10)]:null},loadingImgPath:function(a){return b.path(a,16)},onResize:function(a,b,d,e){var f=a.find(".oo-collection-item-outer-dummy .oo-collection-item-inner").first(),g=d,h=e.internalData||{};if(g){var i=g;b.cb&&(i-=f.find(".oo-collection-item-chunk[oui-chunk=cb]").outerWidth()),i-=f.find(".oo-collection-item-chunk[oui-chunk=icon]").outerWidth(),b.rightAction&&(i-=f.find(".oo-collection-item-chunk[oui-chunk=rightAction]").outerWidth());var j=parseFloat(f.css("font-size"),10);h.nameWidth=i/j+"em",a.find(".oo-collection-item-outer .oo-collection-item-chunk[oui-chunk=name]").css("width",h.nameWidth);var k=b.footer;if(k&&k.length){i=g;var l=0;$.each(k,function(a,b){var d=c.getChunkTpl(b);if(!b.width&&b.minWidth||!d.width&&d.minWidth||1===k.length)l++;else{var e=b.width||b.minWidth||d.width||d.minWidth;i-=parseFloat(e)}}),h.footersWidth=[],$.each(k,function(b,d){var e=c.getChunkTpl(d),f=parseFloat(d.width||d.minWidth||e.width||e.minWidth,10);(!d.width&&d.minWidth||!e.width&&e.minWidth||1===k.length)&&(f=i/l,h.footersWidth[b]=f/j+"em",a.find(".oo-collection-item-outer .oo-collection-item-chunk[oui-chunk=footer_"+b+"]").css("width",h.footersWidth[b]))})}}}},list:{cls:"oo-collection-list-item",renderer:function(a,b,c,e){var f=[],g=e.internalData||{};return $.each(c.columns,function(c,e){f.push('<div class="oo-collection-item-col">',d.getChunkHtml(a,b,e,c,g.columnsWidth?g.columnsWidth[c]:null),"</div>")}),f.join("")},getChunkCfgFromId:function(a,b){return a.columns[parseInt(b,10)]},loadingImgPath:function(a){return b.path(a,16)},onResize:function(a,b,d,e){var f=b.columns,g=e.internalData||{},h=0;$.each(f,function(a,b){var d=c.getChunkTpl(b),e=b.width||b.minWidth||d.width||d.minWidth;h+=e?parseFloat(e,10):0});var i=parseFloat(a.find(".oo-collection-item-outer").css("font-size"),10),j=d/i;if(!isNaN(j)&&h>j?(j=h,a.find(".oo-collection-item-outer").css("width",h+"em")):a.find(".oo-collection-item-outer").css("width","auto"),!isNaN(j)){var k=j,l=0;$.each(f,function(a,b){var d=c.getChunkTpl(b);if(!b.width&&b.minWidth||d&&!d.width&&d.minWidth)l++;else{var e=b.width||b.minWidth||d&&d.width||d&&d.minWidth;k-=parseFloat(e)}}),g.columnsWidth=[],$.each(f,function(b,d){var e=c.getChunkTpl(d),f=parseFloat(d.width||d.minWidth||e&&e.width||e&&e.minWidth,10);(!d.width&&d.minWidth||e&&!e.width&&e.minWidth)&&(f=k/l,g.columnsWidth[b]=f+"em",a.find(".oo-collection-item-outer .oo-collection-item-chunk[oui-chunk="+b+"]").css("width",g.columnsWidth[b]))})}}}};a.module("oui.collection.service").factory("$_ouiCollection_tpl_items",["$loadingImg","$_ouiCollection_html_gen_chunk","$_ouiCollection_tpl_chunks",function(a,f,g){return b=a,d=f,c=g,{templates:e,getItemTpl:function(a){return a&&a.type?e[a.type]:null}}}])}(),function(){a.module("oui.collection.sort",["oui-templates-collection","oui.focus"]).directive("ouiCollectionSort",function(){return{require:"^?ouiCollectionHeader",restrict:"AE",scope:{sorts:"=?ouiCollectionSort",sort:"=?",sortName:"=?",sortAsc:"=?"},controller:["$scope","$element","$filter","$timeout",function(a,b,c,d){a.getCurrentSortLabel=function(){return a.sort?c("i18nOrText")(a.sort.text):""},a.onSortClick=function(c){b.blur(),d(function(){a.sort=c,a.sortName=c.name,a.sortAsc=c.defaultDesc?!1:!0})},a.onOrderClick=function(c){b.blur(),d(function(){a.sortAsc=c})}}],link:function(a,b,c,d){d&&d.setSort(a)},templateUrl:"oui-collection/sort/sort.tpl.html",replace:!0}})}(),function(){a.module("oui.collection.tiles",["oui.collection.service"]).directive("ouiTiles",["$ouiCollection",function(a){return{restrict:"AE",scope:{config:"=?ouiTiles",data:"=?",absoluteItems:"=?",itemConfig:"=?tileConfig",nbSelected:"=?",selectedIds:"=?",listController:"=?ouiTilesController",limitWatchers:"=?limitWatchers",cartController:"=?cartController",loading:"=?loading",sort:"=?sort",filter:"=?filter",page:"=?",pageCount:"=?"},controller:["$scope","$attrs","$element",function(b,c,d){b.collectionType=c.collectionType||"tiles",a.populateScope(b,d,c)}],templateUrl:a.template,replace:!0}}])}(),function(){a.module("oui.collection.views",["oui-templates-collection"]).directive("ouiCollectionViews",function(){return{restrict:"AE",scope:{ngModel:"=?ngModel"},controller:["$scope",function(a){a.switchView=function(b){a.ngModel=b}}],templateUrl:"oui-collection/views/views.tpl.html",replace:!0}})}(),function(a){a.module("oui-templates-collection",["oui-collection/cart/cartTitle.tpl.html","oui-collection/crumbs/crumbs.tpl.html","oui-collection/filter/filter.tpl.html","oui-collection/header/header.tpl.html","oui-collection/mixed/mixed.tpl.html","oui-collection/service/collection.tpl.html","oui-collection/sort/sort.tpl.html","oui-collection/views/views.tpl.html"]),a.module("oui-collection/cart/cartTitle.tpl.html",[]).run(["$templateCache",function(a){a.put("oui-collection/cart/cartTitle.tpl.html",'<span class="oo-collection-cart-title">\n	<span class="oo-text">\n		{{getTitle()}}\n	</span>\n	<span class="oo-form-button-picto icon-corbeille" ng-click="emptyClick()"></span>\n</span>')}]),a.module("oui-collection/crumbs/crumbs.tpl.html",[]).run(["$templateCache",function(a){a.put("oui-collection/crumbs/crumbs.tpl.html",'<div class="oo-collection-crumbs-container">\n	<div class="oo-collection-crumbs">\n		<span class="oo-crumb-home" ng-click="crumbsConfig.onHomeClick()">\n			<i class="icon-back"></i>\n			<span class="oo-text">{{crumbsConfig.homeLabel | i18nOrText}}</span>\n		</span>\n		<span class="oo-collection-crumb-susp">\n			<i class="icon-circle_forward"></i>\n			<span class="oo-text">...</span>\n		</span>\n		<span ng-repeat="crumb in crumbs" class="oo-collection-crumb"\n			ng-class="{\'oo-clickable\':crumbsConfig.isClickable(crumb)}">\n			<i class="icon-circle_forward"></i>\n			<span class="oo-text" oui-crumbs-idx="{{$index}}">{{getLabel(crumb) | i18nOrText}}</span>\n		</span>\n		<div ng-show="isListFiltered()" oui-collection-filter="filterValue"></div>\n	</div>\n	<div class="oo-collection-crumbs oo-collection-crumbs-full">\n		<span class="oo-crumb-home" ng-click="crumbsConfig.onHomeClick()">\n			<i class="icon-back"></i>\n			<span class="oo-text">{{crumbsConfig.homeLabel | i18nOrText}}</span>\n		</span>\n		<span class="oo-collection-crumb-susp">\n			<i class="icon-circle_forward"></i>\n			<span class="oo-text">...</span>\n		</span>\n		<span ng-repeat="crumb in crumbs" class="oo-collection-crumb"\n			ng-class="{\'oo-clickable\':crumbsConfig.isClickable(crumb)}">\n			<i class="icon-circle_forward"></i>\n			<span class="oo-text" oui-crumbs-idx="{{$index}}">{{getLabel(crumb)}}</span>\n		</span>\n	</div>\n	<div class="oo-collection-crumbs oo-collection-crumbs-dummy">\n		<span class="oo-crumb-home">\n			<i class="icon-back"></i>\n			<span class="oo-text">{{crumbsConfig.homeLabel | i18nOrText}}</span>\n		</span>\n		<span class="oo-collection-crumb-susp">\n			<i class="icon-circle_forward"></i>\n			<span class="oo-text">...</span>\n		</span>\n		<span ng-repeat="crumb in crumbs" class="oo-collection-crumb"\n			ng-class="{\'oo-clickable\':crumbsConfig.isClickable(crumb)}">\n			<i class="icon-circle_forward"></i>\n			<span class="oo-text">{{getLabel(crumb)}}</span>\n		</span>\n	</div>\n</div>')}]),a.module("oui-collection/filter/filter.tpl.html",[]).run(["$templateCache",function(a){a.put("oui-collection/filter/filter.tpl.html",'<div class="oo-collection-filter-value">\n	<div class="oo-collection-filter-value-content">\n		<div class="oo-collection-filter-value-content-inner">\n			{{filterValue}}\n		</div>\n	</div>\n	<div class="oo-collection-filter-value-arrow"></div>\n	<div class="icon-point"></div>\n	<div class="icon-close" ng-click="clearFilter()"></div>\n</div>')}]),a.module("oui-collection/header/header.tpl.html",[]).run(["$templateCache",function(a){a.put("oui-collection/header/header.tpl.html",'<div class="oo-collection-header">\n	<div ng-show="false" ng-transclude></div>\n	<div class="oo-collection-header-inner oui-vertical-center"></div>\n</div>')}]),a.module("oui-collection/mixed/mixed.tpl.html",[]).run(["$templateCache",function(a){a.put("oui-collection/mixed/mixed.tpl.html",'<div class="oui-mixed-collection" style="width: 100%; height: 100%">\n	<div ng-show="view===\'list\'"\n		oui-list="config"\n		line-config="lineConfig"\n		columns="columns"\n		absolute-items="absoluteItems"></div>\n	<div ng-show="view===\'tiles\'"\n		oui-tiles="config"\n		tile-config="tileConfig"\n		absolute-items="absoluteItems"></div>\n</div>')}]),a.module("oui-collection/service/collection.tpl.html",[]).run(["$templateCache",function(a){a.put("oui-collection/service/collection.tpl.html",'<div class="oo-collection" ng-class="getCollectionClass()">\n	<div ng-if="colData.ngMode" ng-show="colData.isDataDisplayed(true)" class="oo-collection-inner" lr-infinite-scroll="colData.onInfiniteScroll" scroll-threshold="{{colData.lazy.scrollThreshold}}" time-threshold="{{colData.lazy.timeThreshold}}">\n		<div class="oo-collection-width oui-before"></div>\n		<div class="oo-collection-item-outer oo-collection-item-outer-dummy oui-before" ng-style="getItemOuterStyle(null)" ng-class="getItemOuterClass(null)" ng-bind-html="getItemHtml(null)"></div>\n		<div ng-repeat="elt in colData.pageData" class="oo-collection-item-outer"\n			ng-style="getItemOuterStyle(elt)" ng-class="getItemOuterClass(elt)"\n			ng-bind-html="getItemHtml(elt)">\n		</div>\n	</div>\n	<div ng-if="!colData.ngMode" ng-show="colData.isDataDisplayed(true)" class="oo-collection-inner" lr-infinite-scroll="colData.onInfiniteScroll" scroll-threshold="{{colData.lazy.scrollThreshold}}" time-threshold="{{colData.lazy.timeThreshold}}">\n		<div class="oo-collection-width oui-before"></div>\n		<div class="oo-collection-item-outer oo-collection-item-outer-dummy oui-before" ng-style="getItemOuterStyle(null)" ng-class="getItemOuterClass(null)" ng-bind-html="getItemHtml(null)"></div>\n	</div>\n	<div ng-show="colData.isEmptyDisplayed(false)" class="oo-collection-inner-empty">\n		<div class="oo-collection-empty-outer"\n			ng-style="getItemOuterStyle()" ng-class="getItemOuterClass()">\n			<div class="oo-collection-empty">\n				<div class="oo-collection-empty-inner">\n					<div class="oo-collection-empty-ico">\n						<i class="icon-vide"></i>\n					</div>\n					<div class="oo-collection-empty-text">\n						{{colData.getConfigValue(filter ? "filteredEmptyText" : "emptyText") | i18nOrText}}\n					</div>\n				</div>\n			</div>\n		</div>\n	</div>\n	<div ng-show="colData.isLoadingDisplayed()" class="oo-collection-inner-loading">\n		<div class="oo-collection-loading-outer"\n			ng-style="getItemOuterStyle()" ng-class="getItemOuterClass()">\n			<div class="oo-collection-loading">\n				<div class="oo-collection-loading-inner">\n					<div class="oo-collection-loading-ico">\n						<img ng-src="{{getLoadingImgPath()}}"/>\n					</div>\n					<div class="oo-collection-loading-text">\n						{{colData.getConfigValue("loadingText") | i18nOrText}}\n					</div>\n				</div>\n			</div>\n		</div>\n	</div>\n</div>')}]),a.module("oui-collection/sort/sort.tpl.html",[]).run(["$templateCache",function(a){a.put("oui-collection/sort/sort.tpl.html",'<span class="oo-collection-sort" tabindex="0">\n	<span class="oo-text">{{\'oui.collection.sort.sortBy\' | i18n:[getCurrentSortLabel()]}}</span><i class="icon-circle_down"></i>\n	<div class="oo-collection-sort-list" tabindex="-1">\n		<ul class="oo-sort-list">\n			<li ng-repeat="s in sorts"\n				ng-class="{\'oo-selected\':sort===s}"\n				ng-click="onSortClick(s)">\n				<i class="icon-point"></i><span>{{s.text | i18nOrText}}</span>\n			</li>\n		</ul>\n		<hr/>\n		<ul class="oo-sort-order">\n			<li ng-class="{\'oo-selected\':sortAsc===true}"\n				ng-click="onOrderClick(true)">\n				<i class="icon-point"></i><span>{{\'oui.collection.sort.asc\' | i18n}}</span>\n			</li>\n			<li ng-class="{\'oo-selected\':sortAsc===false}"\n				ng-click="onOrderClick(false)">\n				<i class="icon-point"></i><span>{{\'oui.collection.sort.desc\' | i18n}}</span>\n			</li>\n		</ul>\n	</div>\n</span>')}]),a.module("oui-collection/views/views.tpl.html",[]).run(["$templateCache",function(a){a.put("oui-collection/views/views.tpl.html",'<span class="oo-collection-views">\n	<button class="oo-form-button-picto icon-liste_ligne" ng-click="switchView(\'list\')" ng-class="{\'oo-selected\':ngModel===\'list\'}"></button>\n	<button class="oo-form-button-picto icon-liste_tuile" ng-click="switchView(\'tiles\')" ng-class="{\'oo-selected\':ngModel===\'tiles\'}"></button>\n</span>')}])}(a)}(angular);