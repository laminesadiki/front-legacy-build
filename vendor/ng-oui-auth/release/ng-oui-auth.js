/**
 * ng-oui-auth - v3.0.0 - 2014-11-05
 *
 * Copyright (c) 2014 Oodrive
 */
!function(a){!function(){var b="KO",c="PWD",d="PWD_SENT",e="SMS",f="CAPTCHA",g="OK",h="i18n:oui.auth.error.credentials",i="i18n:oui.auth.error.credentials_tries",j="i18n:oui.auth.error.sms",k="i18n:oui.auth.error.captcha",l="i18n:oui.auth.error.session",m="i18n:oui.auth.error.unknown";a.module("oui.auth",["oo.i18n"]).provider("$ouiAuth",function(){var n=g,o=null,p=null,q=null,r=null,s=null,t=function(b){return a.isDefined(b)?void(n=b):n};this.authState=t,this.userName=function(b){return a.isDefined(b)?void(o=b):o};var u=function(b){return a.isDefined(b)?void(p=b):p};this.logoutFn=u,this.AUTH_STATE_KO=b,this.AUTH_STATE_PWD=c,this.AUTH_STATE_PWD_SENT=d,this.AUTH_STATE_SMS=e,this.AUTH_STATE_CAPTCHA=f,this.AUTH_STATE_OK=g,this.$get=["$rootScope","$filter",function(p,t){var v=function(b,c){return a.isDefined(b)?(r=b,s=null,arguments.length>1&&(s=a.isArray(c)?c:[].slice.call(arguments,1)),void 0):r},w=function(){return r&&t("i18nOrText")(r,s)},x=null;return x={authState:function(b){if(!a.isDefined(b))return n;if(n!==b){var c=n;n=b,p.$broadcast("$authStateChange",n,c)}},userName:function(b){if(!a.isDefined(b))return o;if(o!==b){var c=o;o=b,p.$broadcast("$userNameChange",o,c)}},userNameFn:function(b){return a.isDefined(b)?void(q!==b&&(q=b,x.userName(x.authState()===x.AUTH_STATE_OK?q():null))):q},logoutFn:u,errorMsg:v,computeErrorMsg:w,clearErrorMsg:function(){v(null)},logout:function(){u()()},AUTH_STATE_KO:b,AUTH_STATE_PWD:c,AUTH_STATE_PWD_SENT:d,AUTH_STATE_SMS:e,AUTH_STATE_CAPTCHA:f,AUTH_STATE_OK:g,AUTH_ERROR_CREDENTIALS:h,AUTH_ERROR_CREDENTIALS_TRIES:i,AUTH_ERROR_SMS:j,AUTH_ERROR_CAPTCHA:k,AUTH_ERROR_SESSION:l,AUTH_ERROR_UNKNOWN:m},p.$on("$authStateChange",function(){q&&x.userName(x.authState()===x.AUTH_STATE_OK?q():null)}),x}]}).provider("ouiAuthUnauthorizedInterceptor",function(){var b=[],c=l,d=function(a){b.push(a)};this.addIgnored=d,this.errorMsg=function(b){return a.isDefined(b)?void(c=b):c};var e=function(a,c){for(var d=0;d<b.length;++d)if("string"==typeof b[d]){if(b[d]===a)return!0}else if("function"==typeof b[d]){if(b[d](a,c))return!0}else if(b[d]&&b[d].test&&b[d].test(a))return!0;return!1};this.$get=["$q","$ouiAuth",function(a,b){var f=function(a){b.errorMsg(a||c),b.authState(b.AUTH_STATE_KO)};return{addIgnored:d,redirectOnUnauthorized:f,responseError:function(b){return 401===b.status&&(e(b.config.url,b.data)||f()),a.reject(b)}}}]})}()}(angular);